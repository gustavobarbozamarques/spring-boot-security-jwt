%% Authorization Flow
sequenceDiagram
    actor User
    User->>JwtAuthenticationFilter: Header Authorization:<br/>Bearer <access token><br/>GET /api/private/user
    activate JwtAuthenticationFilter
    JwtAuthenticationFilter->>JwtService: extractAuthentication()
    activate JwtService
    Note over JwtService: Validate access_token<br/>Extract username and roles
    JwtService-->>JwtAuthenticationFilter: Authentication
    deactivate JwtService
    JwtAuthenticationFilter->>SecurityContext: setAuthentication()
    activate SecurityContext
    JwtAuthenticationFilter->>PrivateController: filterChain.doFilter()
    activate PrivateController
    Note over PrivateController: Authorization handled<br/>by Spring Security
    PrivateController-->>JwtAuthenticationFilter: "Welcome user"
    deactivate PrivateController
    JwtAuthenticationFilter-->>User: "Welcome user"
    deactivate SecurityContext
    deactivate JwtAuthenticationFilter